# 枚举

## 数字枚举

```ts
// 默认定义，值从0开始，即：Up = 0，Down = 1，Left = 2，Right = 3
enum Direction {
  Up,
  Down,
  Left,
  Right,
}

// 定义并初始化，Up初始化为1，后面的值依次递增，则：Down = 2，Left = 3，Right = 4
enum Direction {
  Up = 1,
  Down,
  Left,
  Right,
}
```

1. 数字枚举的枚举成员必须是数字
2. 枚举值会自增初始化，枚举成员的值等于前一个的值加 1，如果是第一个并且没有设置初始化时，值则为 0

## 字符串枚举

```ts
enum Direction {
  Up = "UP",
  Down = "DOWN",
  Left = "LEFT",
  Right = "RIGHT",
}
```

1. 字符串枚举的枚举成员必须是字符串
2. 枚举值不会自增，必须全部手动初始化
3. 字符串枚举提供了运行时有意义的并且可读的值

## 异构枚举

混合了数字成员和字符串成员的枚举，技术上是可行的，但并不推荐使用

```ts
enum HeterogeneousEnum {
  ON = 1,
  OFF = "OFF",
}
```

## 枚举成员：计算成员、常量成员

枚举成员的值，可以是 _常量_ 的或者是 _计算_ 的

**常量枚举成员**
满足以下任一情况的，即为 _常量枚举成员_

1. 枚举的第一个成员并且未设置初始化，其最终值为 _0_
2. 未设置初始化并且其前一个成员的值是数字，则其最终值为上一个成员的值加 1
3. 枚举成员使用 _常量枚举表达式_ 初始化

**常量枚举表达式**
满足以下的任一条件的，即为 _常量枚举表达式_

1. 字面量枚举表达式（字符串字面量、数字字面量）
2. 对之前定义的常量枚举成员的引用（可以是不同枚举类型中定义的）
3. 带圆括号的常量枚举表达式
4. 一元运算符 `+`、`-`、`~` 其中之一应用于常量枚举表达式
5. 常量枚举表达式作为二元运算符 `+`、`-`、`*`、`/`、`%`、`<<`、`>>`、`>>>`、`&`、`|`、`^` 的操作对象。

若常量枚举表达式求值后是 `NaN` 或者 `Infinity`，编译会报错。

```ts
enum FileAccess {
  // 常量枚举成员
  None,
  Read = 1 << 1,
  Write = 1 << 2,
  ReadWrite = Read | Write,
  // 计算枚举成员
  G = "123".length,
}
```

## 联合枚举

**字面量枚举成员**
_字面量枚举成员_ 是值不带初始值的常量枚举成员，或者是值初始化为：

1. 任意字符串字面量
2. 任意数字字面量
3. 应用了一元运算符 `-` 的数字数字字面量

当所有的枚举成员都拥有字面量枚举值时，它将带有一种特殊的语义

1. 枚举成员成为了类型
2. 枚举类型本身变成了每个枚举成员的联合

```ts
enum ShapeKind {
  Circle,
  Square,
}
interface Circle {
  kind: ShapeKind.Circle;
  radius: number;
}
interface Square {
  kind: ShapeKind.Square;
  sideLength: number;
}
// ShapeKind 是 Circle 与 Square 类型的联合，即：Circle | Square
// 其成员 ShapeKind.Circle 与 ShapeKind.Square 都是独立的类型
```

## 运行时的枚举

枚举在运行时是真正存在的对象

### 反向映射

枚举创建的对象，除了有枚举成员名作为属性名的对象属性外，对于 _数字枚举_，还具有枚举成员值作为属性名的对象属性

```ts
enum Enum {
  A,
  B,
}

let aValue = Enum.A; // 输出：0
let aName = Enum[aValue]; // 输出：A
```

### `const` 枚举

```ts
const enum Enum {
  A = 1,
  B = A * 2,
}
```

1. 常量枚举只能使用常量枚举表达式
2. 常量枚举在编译阶段会被删除

## 外部枚举

外部枚举用于描述已经存在的枚举类型

```ts
declare enum Enum {
  A = 1,
  B,
  C = 2,
}
```

外部枚举与非外部枚举的区别：
一般的枚举里，没有初始化的成员视为常量成员，而外部枚举这里，没有初始化的成员视为计算成员
